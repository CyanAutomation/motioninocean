# Motion In Ocean Camera Configuration
# Copy this file to .env and customize as needed

# ========== IMPORTANT: Variable Semantics ==========
# Empty values vs. 0:
#   - Empty or unset (e.g., MOTION_IN_OCEAN_TARGET_FPS=) → Application decides (often defaults to another variable)
#   - 0 (e.g., MOTION_IN_OCEAN_FPS=0) → Usually means "auto" or "disabled" depending on context
#   See specific variable comments for exact behavior.
#
# Mode-dependent variables:
#   - MOTION_IN_OCEAN_MODE controls which app features and endpoints are available:
#     * webcam: Camera streaming service with /stream.mjpg, /snapshot.jpg endpoints
#     * management: Node registry API service with /api/nodes/* endpoints
#   - Camera settings (RESOLUTION, FPS, etc.) apply only to webcam mode.
#     Management mode reads but safely ignores these settings.
#   - HEALTHCHECK_READY controls the health probe behavior:
#     * true: Uses /ready endpoint (readiness probe)
#     * false: Uses /health endpoint (liveness probe)
# ===================================================

# Docker Image Tag
# Used for all container images (motion-in-ocean and docker-socket-proxy)
# Both services are versioned together for consistency
MOTION_IN_OCEAN_IMAGE_TAG=latest

# Motion In Ocean Web Server Port
# Valid range: 1024-65535 (use unprivileged ports 1024+ for security)
# Used by both webcam and management modes on the unified service
# Default: 8000
MOTION_IN_OCEAN_PORT=8000

# Motion In Ocean Service Mode
# Controls which features and endpoints are available
# Options: "webcam" or "management"
# - webcam: Camera streaming service (requires device access)
# - management: Node registry management API service (no hardware required)
# Default: webcam
MOTION_IN_OCEAN_MODE=webcam

# Pi 3 profile presets (recommended for Raspberry Pi 3)
# When enabled, missing runtime vars default to:
#   RESOLUTION=640x480, FPS=12, TARGET_FPS=12, JPEG_QUALITY=75, MAX_STREAM_CONNECTIONS=3
# Manual values always win when explicitly set.
# Note: This setting only applies in webcam mode. Management mode does not use camera settings.
# Passed to container as MOTION_IN_OCEAN_PI3_PROFILE environment variable.
MOTION_IN_OCEAN_PI3_PROFILE=true

# ========== Camera Configuration ==========
# The following settings apply ONLY in webcam mode (MOTION_IN_OCEAN_MODE=webcam).
# Management mode does not initialize the camera; these settings are safely ignored.
# ==========================================

# Camera Resolution (WIDTHxHEIGHT)
# Common values: 640x480, 1280x720, 1920x1080
# Maximum: 4096x4096 (hardware dependent)
# Hardware-specific recommendations for balanced performance:
#   Pi 3: 1280x720 or 1640x1232 (limited CPU, prioritize lower resolutions)
#   Pi 4: 1920x1080 (good balance of quality and performance)
#   Pi 5: 1920x1080 or 2592x1944 (can handle higher resolutions smoothly)
# Note: Higher resolutions increase CPU usage, memory, and network bandwidth
MOTION_IN_OCEAN_RESOLUTION=640x480

# Frame Rate (FPS) - 0 uses camera default
# Hardware-specific recommendations:
#   Pi 3: 30fps @ 1640x1232, 25fps @ 1920x1080 (CPU-limited, lower FPS for higher resolutions)
#   Pi 4: 30fps @ 1920x1080, up to 60fps @ 1280x720 (better performance, more headroom)
#   Pi 5: 60fps @ 1920x1080, up to 120fps @ 1280x720 (best performance, handles high FPS well)
# Note: Higher FPS increases CPU usage and network bandwidth. Monitor system load.
MOTION_IN_OCEAN_FPS=0

# Target output frame rate throttle (output FPS limiter)
# Empty or unset: Disables throttling; output will follow MOTION_IN_OCEAN_FPS
# 0 (zero): Explicitly disables throttling; output will follow MOTION_IN_OCEAN_FPS
# N (positive integer): Throttles output to N frames per second regardless of capture FPS
# Example: Capture at 60 FPS but output only 10 FPS to save bandwidth: FPS=60, TARGET_FPS=10
MOTION_IN_OCEAN_TARGET_FPS=

# JPEG Quality (1-100)
# Lower values reduce bandwidth but decrease image quality
# 100 is maximum quality (default)
# Set to 80 for a good balance between quality and bandwidth
# Set to 60-70 for bandwidth-constrained networks
MOTION_IN_OCEAN_JPEG_QUALITY=100

# Maximum concurrent clients allowed on /stream.mjpg
# Pi 3 recommendation: 2-3 clients
MOTION_IN_OCEAN_MAX_STREAM_CONNECTIONS=2

# OctoPrint Compatibility Mode
# Enable OctoPrint-compatible webcam routes (/webcam/?action=stream and /webcam/?action=snapshot)
# When disabled (false), use native routes: /stream.mjpg and /snapshot.jpg
# Only enable if you're connecting to OctoPrint
MOTION_IN_OCEAN_OCTOPRINT_COMPATIBILITY=false

# CORS Origins (comma-separated)
# Restricts which origins can access the camera stream from browsers
# ⚠️  WARNING: Using "*" allows ANY website to access your camera stream. Not recommended for production.
# Safe LAN examples:
#   Single origin: http://homeassistant.local:8123
#   Multiple origins: http://homeassistant.local:8123,http://octoprint.local,http://192.168.1.100:3000
# For production or internet-facing deployments, always specify exact origins.
MOTION_IN_OCEAN_CORS_ORIGINS=*

# Mock Camera Mode (for testing without hardware)
# Set to 'true' to use synthetic test patterns instead of real camera
MOCK_CAMERA=true

# Healthcheck Configuration
# Controls which health endpoint is used by Docker healthchecks
# - true: Uses /ready endpoint (readiness probe)
#   * In webcam mode: Waits for camera stream to be active
#   * In management mode: Returns immediate success
# - false: Uses /health endpoint (liveness probe; always returns 200 immediately)
# Default: true (recommended for readiness-based probes)
MOTION_IN_OCEAN_HEALTHCHECK_READY=true

# ========== Management / Node Token Configuration ==========
# These settings have mode-dependent behavior:
#   - management profile: protects management API endpoints (/api/nodes*, /api/management/overview)
#   - webcam profile: protects node control-plane endpoints (/health, /ready, /metrics, /api/actions/*)
# Use the same token on the remote webcam host and in management node auth (bearer) for node handshakes.

# Management API Authentication
# MANAGEMENT_AUTH_REQUIRED: When true, all management API endpoints require bearer token authentication
# When false, API endpoints are accessible without authentication (suitable for localhost-only deployments)
# Default: true (strongly recommended for production/network-accessible deployments)
MANAGEMENT_AUTH_REQUIRED=false

# Management / Webcam Node Bearer Token
# Reused by mode:
#   - management profile: management API bearer token
#   - webcam profile: node control-plane bearer token
# If set (non-empty), protected endpoints require this token in the Authorization header.
# If empty, authentication is disabled for those protected endpoints.
# Format: Authorization: Bearer <token>
#
# Example:
#   MANAGEMENT_AUTH_TOKEN=my-secret-token
#   Production recommendation: Use strong random tokens (e.g., `openssl rand -hex 32`)
#
# Default: empty (no authentication required)
MANAGEMENT_AUTH_TOKEN=

# ===================================================
